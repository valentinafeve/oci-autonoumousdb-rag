## Vamos a crear las credenciales 

Es necesario crear las credenciales utilizando el paquete DBMS_CLOUD y la función CREATE_CREDENTIAL

```sql
BEGIN
DBMS_CLOUD.CREATE_CREDENTIAL(
    credential_name => 'GENAI_CRED',
    user_ocid       => 'ocid1.user...',
    tenancy_ocid    => 'ocid1.tenancy...',
    private_key     => '',
    fingerprint     => '6d:23:aa:cf:a3:f4'
  );
END;
```

## Creación de una tabla para almacenar la metadata de los documentos

A continuación, es necesario crear una tabla para almacenar la metadata de los documentos.

```sql
CREATE TABLE IF NOT EXISTS "TB_DATA"
    ( 
    ID    INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY 
          ( START WITH 1 CACHE 20 ) PRIMARY KEY, 
    file_name      VARCHAR2 (900) , 
    file_size      INTEGER , 
    file_type       VARCHAR2 (100) , 
    file_content    BLOB
    )
```

## Creación de una tabla para almacenar los documentos vectorizados

También vamos a crear una tabla para almacenar los vectores de los documentos.

```sql
CREATE TABLE IF NOT EXISTS "TB_VECTOR_DATA"
  (    "VEC_ID" NUMBER(*,0) NOT NULL ENABLE,
  "EMBED_ID" NUMBER,
  "EMBED_DATA" VARCHAR2(4000 BYTE),
  "EMBED_VECTOR" VECTOR,
    FOREIGN KEY (VEC_ID) REFERENCES TB_DATA(ID)
  )
```

## Descargamos un pdf que vamos a vectorizar

Dependiendo de la región en donde se creó nuestra base de datos, seleccionamos alguno de los URLs correspondientes.
### URL del PDF para Chicago
```

```
### URL del PDF para Sao Paulo
```

```


El siguiente comando va a descargar el pdf en la base de datos
```sql
BEGIN
   DBMS_CLOUD.GET_OBJECT(
   credential_name => 'GENAI_CRED',
   object_uri => 'url del pdf',
   directory_name => 'DATA_PUMP_DIR');
END;
```

El siguiente comando va a descargar el modelo de vectorización en la base de datos
```sql
BEGIN
   DBMS_CLOUD.GET_OBJECT(
   credential_name => 'GENAI_CRED',
   object_uri => 'url del modelo',
   directory_name => 'DATA_PUMP_DIR');
END;
```

Es necesario registrar el modelo de vectorización en la base de datos
```sql
BEGIN
  DBMS_VECTOR.LOAD_ONNX_MODEL(directory=>'DATA_PUMP_DIR',
                              file_name=>'all-MiniLM-L6.onnx',
                              model_name=>'all_MiniLM_L6',
                              metadata=>JSON('{"function" : "embedding", "embeddingOutput" : "embedding", "input": {"input": ["DATA"]}}')
                               );
END;
```

Ahora vamos a almacenar el pdf en la base de datos
```sql
insert into "TB_DATA"(file_name,file_size,file_type,file_content)  
values  ('Champ.pdf',
         dbms_lob.getlength(to_blob(bfilename('DATA_PUMP_DIR', 'tesisd4e02f46-9b92-4366-a3f2-3bdceb855c2f_Tesis_Interpretando_modelos.pdf'))),
         'PDF', 
         to_blob(bfilename('DATA_PUMP_DIR', 'tesisd4e02f46-9b92-4366-a3f2-3bdceb855c2f_Tesis_Interpretando_modelos.pdf') )
        )
```